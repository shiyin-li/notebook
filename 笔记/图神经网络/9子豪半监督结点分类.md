## 半监督节点分类（label propagation）

#### 两个概念（直推式学习 transductive和归纳式学习 inductive）

![image-20230414150050005](../../assets/9子豪半监督结点分类/image-20230414150050005.png)

``直推式学习：训练模型前后不会改变 图的形状前后不变``

![image-20230414150432173](../../assets/9子豪半监督结点分类/image-20230414150432173.png)

#### 例子

![image-20230414150643974](../../assets/9子豪半监督结点分类/image-20230414150643974.png)

![image-20230414151008422](../../assets/9子豪半监督结点分类/image-20230414151008422.png)



### 重要的对比

![image-20230414151237996](../../assets/9子豪半监督结点分类/image-20230414151237996.png)



![image-20230414151532416](../../assets/9子豪半监督结点分类/image-20230414151532416.png)

### 标签传播和集体分类

![image-20230414151742275](../../assets/9子豪半监督结点分类/image-20230414151742275.png)

![image-20230414151844741](../../assets/9子豪半监督结点分类/image-20230414151844741.png)

![image-20230414152116783](../../assets/9子豪半监督结点分类/image-20230414152116783.png)

![image-20230414152205062](../../assets/9子豪半监督结点分类/image-20230414152205062.png)

![image-20230414152249052](../../assets/9子豪半监督结点分类/image-20230414152249052.png)

![image-20230414152331056](../../assets/9子豪半监督结点分类/image-20230414152331056.png)

#### 进入正题

![image-20230414152413491](../../assets/9子豪半监督结点分类/image-20230414152413491.png)

#### 最简单knn

![image-20230414152437943](../../assets/9子豪半监督结点分类/image-20230414152437943.png)

### lable propagation标签传播算法

![image-20230414152947794](../../assets/9子豪半监督结点分类/image-20230414152947794.png)

![image-20230414153031181](../../assets/9子豪半监督结点分类/image-20230414153031181.png)

#### example

![image-20230414153129880](../../assets/9子豪半监督结点分类/image-20230414153129880.png)

![image-20230414153239136](../../assets/9子豪半监督结点分类/image-20230414153239136.png)

![image-20230414153254083](../../assets/9子豪半监督结点分类/image-20230414153254083.png)

#### iteration：一轮收敛一个  

![image-20230414153344965](../../assets/9子豪半监督结点分类/image-20230414153344965.png)



#### 方法

![image-20230414153527541](../../assets/9子豪半监督结点分类/image-20230414153527541.png)

![image-20230414153556271](../../assets/9子豪半监督结点分类/image-20230414153556271.png)

**缺点**：

- 仅用到网络连接信息，没有用到节点属性特征
- 可能不会convergence（收敛）

#### 代码调包

![image-20230414153958739](../../assets/9子豪半监督结点分类/image-20230414153958739.png)

### ICA算法

![image-20230414154054190](../../assets/9子豪半监督结点分类/image-20230414154054190.png)

![image-20230414154431195](../../assets/9子豪半监督结点分类/image-20230414154431195.png)

![image-20230414154455609](../../assets/9子豪半监督结点分类/image-20230414154455609.png)

![image-20230414155124429](../../assets/9子豪半监督结点分类/image-20230414155124429.png)

#### 方法

![image-20230414155344530](../../assets/9子豪半监督结点分类/image-20230414155344530.png)

#### example

![image-20230414155450515](../../assets/9子豪半监督结点分类/image-20230414155450515.png)

**没使用连接属性 Zv**

![image-20230414155600737](../../assets/9子豪半监督结点分类/image-20230414155600737.png)

**使用连接属性Zv**

![image-20230414155656938](../../assets/9子豪半监督结点分类/image-20230414155656938.png)

**然后按照上面的方法进行训练**

![image-20230414155916339](../../assets/9子豪半监督结点分类/image-20230414155916339.png)

![image-20230414155936294](../../assets/9子豪半监督结点分类/image-20230414155936294.png)

![image-20230414155958743](../../assets/9子豪半监督结点分类/image-20230414155958743.png)

![image-20230414160024098](../../assets/9子豪半监督结点分类/image-20230414160024098.png)

**之后iteration：使用Yz（Φ2）更行Zv，使用Zv更新Yz（Φ2） 达到收敛或者最大迭代次数结束** 

![image-20230414160249385](../../assets/9子豪半监督结点分类/image-20230414160249385.png)

![image-20230414160844970](../../assets/9子豪半监督结点分类/image-20230414160844970.png)

#### 马尔科夫假设

![image-20230414161025471](../../assets/9子豪半监督结点分类/image-20230414161025471.png)

![image-20230414161044420](../../assets/9子豪半监督结点分类/image-20230414161044420.png)

### 总结以上两种算法

![image-20230414161109651](../../assets/9子豪半监督结点分类/image-20230414161109651.png)

### 后处理的算法

![image-20230414161132883](../../assets/9子豪半监督结点分类/image-20230414161132883.png)



#### 方法

![image-20230414161647580](../../assets/9子豪半监督结点分类/image-20230414161647580.png)

![image-20230414161733470](../../assets/9子豪半监督结点分类/image-20230414161733470.png)

![image-20230414161751744](../../assets/9子豪半监督结点分类/image-20230414161751744.png)

##### 后处理将这些不太确信的结点让其变的确信 eg：将8号结点变的确信

![image-20230414162032813](../../assets/9子豪半监督结点分类/image-20230414162032813.png)

![image-20230414162007604](../../assets/9子豪半监督结点分类/image-20230414162007604.png)

![image-20230414163433813](../../assets/9子豪半监督结点分类/image-20230414163433813.png)

#### corretc步骤 传播error matrix矩阵

**是将错误 困惑传播到需要分类的结点**

![image-20230414163643012](../../assets/9子豪半监督结点分类/image-20230414163643012.png)

![image-20230414165141027](../../assets/9子豪半监督结点分类/image-20230414165141027.png)

![image-20230414170001330](../../assets/9子豪半监督结点分类/image-20230414170001330.png)

##### Normalized diffusion（Adjacency） matrix 归一化矩阵

![image-20230414170253834](../../assets/9子豪半监督结点分类/image-20230414170253834.png)

![image-20230414171116991](../../assets/9子豪半监督结点分类/image-20230414171116991.png)

![image-20230414170712326](../../assets/9子豪半监督结点分类/image-20230414170712326.png)

![image-20230414171213782](../../assets/9子豪半监督结点分类/image-20230414171213782.png)

![image-20230414171506523](../../assets/9子豪半监督结点分类/image-20230414171506523.png)

![image-20230414171601532](../../assets/9子豪半监督结点分类/image-20230414171601532.png)

#### smooth步骤 传播置信度matrix

**将初始都有标注的置信度默认为1 对比correct之后的图 **

![image-20230414171800254](../../assets/9子豪半监督结点分类/image-20230414171800254.png)

![image-20230414171818037](../../assets/9子豪半监督结点分类/image-20230414171818037.png)

![image-20230414172212478](../../assets/9子豪半监督结点分类/image-20230414172212478.png)

#### 对比后处理和没后处理的图

![image-20230414172329234](../../assets/9子豪半监督结点分类/image-20230414172329234.png)

![image-20230414172446377](../../assets/9子豪半监督结点分类/image-20230414172446377.png)

![image-20230414172508404](../../assets/9子豪半监督结点分类/image-20230414172508404.png)

### Loopy Belief Propagation 消息传递算法

![image-20230414172711431](../../assets/9子豪半监督结点分类/image-20230414172711431.png)

![image-20230414172812246](../../assets/9子豪半监督结点分类/image-20230414172812246.png)

![image-20230414172856401](../../assets/9子豪半监督结点分类/image-20230414172856401.png)

![image-20230414172925370](../../assets/9子豪半监督结点分类/image-20230414172925370.png)

![image-20230414172941527](../../assets/9子豪半监督结点分类/image-20230414172941527.png)

![image-20230414172956952](../../assets/9子豪半监督结点分类/image-20230414172956952.png)

![image-20230414173102894](../../assets/9子豪半监督结点分类/image-20230414173102894.png)

![image-20230414173239107](../../assets/9子豪半监督结点分类/image-20230414173239107.png)

![image-20230414174057456](../../assets/9子豪半监督结点分类/image-20230414174057456.png)

![image-20230414173901283](../../assets/9子豪半监督结点分类/image-20230414173901283.png)

#### 问题 ：有环怎么办

![image-20230414174146006](../../assets/9子豪半监督结点分类/image-20230414174146006.png)

![image-20230414174246299](../../assets/9子豪半监督结点分类/image-20230414174246299.png)

**不断循环就会加强虚假消息的传播**

![image-20230414174306312](../../assets/9子豪半监督结点分类/image-20230414174306312.png)

![image-20230414174434639](../../assets/9子豪半监督结点分类/image-20230414174434639.png)

#### 优点

![image-20230414174500265](../../assets/9子豪半监督结点分类/image-20230414174500265.png)

### Masked Label Prediction 

![image-20230414175035423](../../assets/9子豪半监督结点分类/image-20230414175035423.png)

![image-20230414175112467](../../assets/9子豪半监督结点分类/image-20230414175112467.png)

![image-20230414175436001](../../assets/9子豪半监督结点分类/image-20230414175436001.png)

``相当于自己挖空做完形填空``

### summary

![image-20230414175849052](../../assets/9子豪半监督结点分类/image-20230414175849052.png)

![image-20230414175911036](../../assets/9子豪半监督结点分类/image-20230414175911036.png)

![image-20230414180108222](../../assets/9子豪半监督结点分类/image-20230414180108222.png)