### 图神经网络的表达能力

![image-20230416151431661](../../assets/13.子豪图神经网络的表达能力/image-20230416151431661.png)

``注：GraphSAGE和GAT没讲``

![image-20230416151734502](../../assets/13.子豪图神经网络的表达能力/image-20230416151734502.png)

![image-20230416151801151](../../assets/13.子豪图神经网络的表达能力/image-20230416151801151.png)

![image-20230416151830533](../../assets/13.子豪图神经网络的表达能力/image-20230416151830533.png)

![image-20230416151844891](../../assets/13.子豪图神经网络的表达能力/image-20230416151844891.png)

![image-20230416152010880](../../assets/13.子豪图神经网络的表达能力/image-20230416152010880.png)

![image-20230416152207804](../../assets/13.子豪图神经网络的表达能力/image-20230416152207804.png)

#### 形成全图的特征工程

![image-20230416152254253](../../assets/13.子豪图神经网络的表达能力/image-20230416152254253.png)

![image-20230416152502138](../../assets/13.子豪图神经网络的表达能力/image-20230416152502138.png)

#### 神经网络的表达能力

**表达能力：是否能拟和出来一个复杂的边界 去进行分类和回归**

![image-20230416152352914](../../assets/13.子豪图神经网络的表达能力/image-20230416152352914.png)

![image-20230416152823718](../../assets/13.子豪图神经网络的表达能力/image-20230416152823718.png)

**一般用多层每层用少量的神经元**

**神经网络最后一层就是一个线性分类曾**

![image-20230416153004919](../../assets/13.子豪图神经网络的表达能力/image-20230416153004919.png)

![image-20230416153111791](../../assets/13.子豪图神经网络的表达能力/image-20230416153111791.png)

![image-20230416153135545](../../assets/13.子豪图神经网络的表达能力/image-20230416153135545.png)

![image-20230416153359991](../../assets/13.子豪图神经网络的表达能力/image-20230416153359991.png)

#### 图神经网络GNN的表达能力

![image-20230416153612350](../../assets/13.子豪图神经网络的表达能力/image-20230416153612350.png)

![image-20230416153636900](../../assets/13.子豪图神经网络的表达能力/image-20230416153636900.png)

![image-20230416153844921](../../assets/13.子豪图神经网络的表达能力/image-20230416153844921.png)

![image-20230416153913185](../../assets/13.子豪图神经网络的表达能力/image-20230416153913185.png)

![image-20230416153927073](../../assets/13.子豪图神经网络的表达能力/image-20230416153927073.png)

![image-20230416154001074](../../assets/13.子豪图神经网络的表达能力/image-20230416154001074.png)

![image-20230416154102316](../../assets/13.子豪图神经网络的表达能力/image-20230416154102316.png)

![image-20230416154149772](../../assets/13.子豪图神经网络的表达能力/image-20230416154149772.png)

![image-20230416154428544](../../assets/13.子豪图神经网络的表达能力/image-20230416154428544.png)

![image-20230416154457914](../../assets/13.子豪图神经网络的表达能力/image-20230416154457914.png)

![image-20230416154531017](../../assets/13.子豪图神经网络的表达能力/image-20230416154531017.png)

![image-20230416154554697](../../assets/13.子豪图神经网络的表达能力/image-20230416154554697.png)

![image-20230416154607702](../../assets/13.子豪图神经网络的表达能力/image-20230416154607702.png)

##### 计算图相同，GNN无法区分

![image-20230416154649734](../../assets/13.子豪图神经网络的表达能力/image-20230416154649734.png)

![image-20230416154732241](../../assets/13.子豪图神经网络的表达能力/image-20230416154732241.png)

##### 计算图不同，GNN能区分吗?

![image-20230416154939826](../../assets/13.子豪图神经网络的表达能力/image-20230416154939826.png)

![image-20230416155007712](../../assets/13.子豪图神经网络的表达能力/image-20230416155007712.png)

![image-20230416155029677](../../assets/13.子豪图神经网络的表达能力/image-20230416155029677.png)

##### 数学的映射

![image-20230416155154316](../../assets/13.子豪图神经网络的表达能力/image-20230416155154316.png)

![image-20230416155210138](../../assets/13.子豪图神经网络的表达能力/image-20230416155210138.png)

![image-20230416155243320](../../assets/13.子豪图神经网络的表达能力/image-20230416155243320.png)

![image-20230416155329578](../../assets/13.子豪图神经网络的表达能力/image-20230416155329578.png)

![image-20230416155342566](../../assets/13.子豪图神经网络的表达能力/image-20230416155342566.png)

![image-20230416155414206](../../assets/13.子豪图神经网络的表达能力/image-20230416155414206.png)

![image-20230416155429278](../../assets/13.子豪图神经网络的表达能力/image-20230416155429278.png)

![image-20230416155447611](../../assets/13.子豪图神经网络的表达能力/image-20230416155447611.png)

#### 分析常见GNN的表达能力    并设计出表达能力最强的GNN

##### 两种GNN的对比

![image-20230416155546284](../../assets/13.子豪图神经网络的表达能力/image-20230416155546284.png)

![image-20230416155557151](../../assets/13.子豪图神经网络的表达能力/image-20230416155557151.png)

![image-20230416155738970](../../assets/13.子豪图神经网络的表达能力/image-20230416155738970.png)

``注:这里的AGGREGATE是逐元素求最大值的操作``

##### GCN不是单射函数（求平均）

![image-20230416155923575](../../assets/13.子豪图神经网络的表达能力/image-20230416155923575.png)

![image-20230416160056017](../../assets/13.子豪图神经网络的表达能力/image-20230416160056017.png)

![image-20230416164354849](../../assets/13.子豪图神经网络的表达能力/image-20230416164354849.png)

##### GraphSAGE也不是单射函数（求最大）

![image-20230416164436821](../../assets/13.子豪图神经网络的表达能力/image-20230416164436821.png)

![image-20230416164504594](../../assets/13.子豪图神经网络的表达能力/image-20230416164504594.png)

![image-20230416164610543](../../assets/13.子豪图神经网络的表达能力/image-20230416164610543.png)

![image-20230416164654146](../../assets/13.子豪图神经网络的表达能力/image-20230416164654146.png)

##### 想法：使用神经网络构建单射函数

![image-20230416164725063](../../assets/13.子豪图神经网络的表达能力/image-20230416164725063.png)

#### Graph lsomorphism(同构) Network  图神经网络GIN

![image-20230416165132694](../../assets/13.子豪图神经网络的表达能力/image-20230416165132694.png)

![image-20230416165310874](../../assets/13.子豪图神经网络的表达能力/image-20230416165310874.png)

![image-20230416165423672](../../assets/13.子豪图神经网络的表达能力/image-20230416165423672.png)

![image-20230416165455988](../../assets/13.子豪图神经网络的表达能力/image-20230416165455988.png)

`注:神经元个数不用太多 100-500就够了`

![image-20230416165619003](../../assets/13.子豪图神经网络的表达能力/image-20230416165619003.png)

![image-20230416165649427](../../assets/13.子豪图神经网络的表达能力/image-20230416165649427.png)

##### WL kernal（传统的ML 人工构造特征） 是消息传递GNN的上限

![image-20230416165745456](../../assets/13.子豪图神经网络的表达能力/image-20230416165745456.png)

![image-20230416165906880](../../assets/13.子豪图神经网络的表达能力/image-20230416165906880.png)

![image-20230416165927066](../../assets/13.子豪图神经网络的表达能力/image-20230416165927066.png)

![image-20230416165947430](../../assets/13.子豪图神经网络的表达能力/image-20230416165947430.png)

![image-20230416165959135](../../assets/13.子豪图神经网络的表达能力/image-20230416165959135.png)

![image-20230416170022135](../../assets/13.子豪图神经网络的表达能力/image-20230416170022135.png)

![image-20230416170040983](../../assets/13.子豪图神经网络的表达能力/image-20230416170040983.png)

![image-20230416170111085](../../assets/13.子豪图神经网络的表达能力/image-20230416170111085.png)

![image-20230416170130830](../../assets/13.子豪图神经网络的表达能力/image-20230416170130830.png)

![image-20230416170213966](../../assets/13.子豪图神经网络的表达能力/image-20230416170213966.png)

##### GIN类比WL kernal

![image-20230416170502653](../../assets/13.子豪图神经网络的表达能力/image-20230416170502653.png)

![image-20230416170530799](../../assets/13.子豪图神经网络的表达能力/image-20230416170530799.png)

![image-20230416170641720](../../assets/13.子豪图神经网络的表达能力/image-20230416170641720.png)

![image-20230416170700575](../../assets/13.子豪图神经网络的表达能力/image-20230416170700575.png)

![image-20230416170755266](../../assets/13.子豪图神经网络的表达能力/image-20230416170755266.png)

![image-20230416170826812](../../assets/13.子豪图神经网络的表达能力/image-20230416170826812.png)

##### 表达能力的对比

![image-20230416170916227](../../assets/13.子豪图神经网络的表达能力/image-20230416170916227.png)

![image-20230416171011866](../../assets/13.子豪图神经网络的表达能力/image-20230416171011866.png)

![image-20230416171135974](../../assets/13.子豪图神经网络的表达能力/image-20230416171135974.png)

``注:1.eg:蓝色的为列向量[1,0] 红色的为列向量[0,1]``

``2.保证顺序不变性:顺序不变性（Order Invariance）指的是某些操作的结果与它们的输入顺序无关。``

##### 再次提高expressive power 就要跳出消息表达能力的范围

idea： 加入标号属性

![image-20230416172001329](../../assets/13.子豪图神经网络的表达能力/image-20230416172001329.png)

![image-20230416172115576](../../assets/13.子豪图神经网络的表达能力/image-20230416172115576.png)

#### GNN工程调参技巧

![image-20230416172354910](../../assets/13.子豪图神经网络的表达能力/image-20230416172354910.png)

![image-20230416172553539](../../assets/13.子豪图神经网络的表达能力/image-20230416172553539.png)

``注:1.zero-grad:是否调到了0梯度或者叫验证测试模式``

``2.仔细观察loss function 和initialization参数 ``

``3.如果出现了overfit 你需要去看train的loss function 和test的loss function是否出现了倒挂？是否要采取早停正则化的技巧``

``4.倒挂:在机器学习中，倒挂（Inverted-U）是一个经验现象，它描述了某些任务在一定程度的难度下，随着问题复杂度的增加，性能表现先得到改善，然后达到峰值，最后性能开始下降。``

![image-20230416173231787](../../assets/13.子豪图神经网络的表达能力/image-20230416173231787.png)

![image-20230416173307851](../../assets/13.子豪图神经网络的表达能力/image-20230416173307851.png)

#### 复盘总结

![image-20230416173405380](../../assets/13.子豪图神经网络的表达能力/image-20230416173405380.png)

![image-20230416173417156](../../assets/13.子豪图神经网络的表达能力/image-20230416173417156.png)

![image-20230416173445233](../../assets/13.子豪图神经网络的表达能力/image-20230416173445233.png)

![image-20230416173622669](../../assets/13.子豪图神经网络的表达能力/image-20230416173622669.png)